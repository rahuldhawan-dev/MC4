@using MapCallMVC.Areas.FieldOperations.Models.ViewModels
@model Service

@{
    var userCanEdit = Html.CurrentUserCanEdit();
    var table = Html.TableFor(x => x.WorkOrdersForDisplay, new {id = "workOrderTable"})
        .TemplateColumnFor("Work Order General", x => Html.ActionLink(x.ToString(), "Show", "WorkOrder", new { x.Id }, null))
        .TemplateColumnFor("Work Order Finalization", x => Html.ActionLink(x.ToString(), "Edit", "WorkOrderFinalization", new { x.Id }, null))
        .ColumnFor(x => x.WorkDescription);
}

@if (userCanEdit)
{
    using (var form = Form.BeginRouteForm("Service", "WorkOrder", new { Model.Id }, ManyToManyRouteAction.Remove))
    {
        form.HtmlAttributes.Add("id", "childTableFooter");
        form.HtmlAttributes.Add("data-confirm", "Are you sure you want to remove this work order link?");
        @table.TemplateColumnFor(x => Control.SubmitButton("Remove Work Order").WithName("WorkOrder").WithValue(x.Id))
    }
}
else
{
  @table
} 