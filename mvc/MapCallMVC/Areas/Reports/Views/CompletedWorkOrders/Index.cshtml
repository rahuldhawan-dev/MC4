@model MapCallMVC.Areas.Reports.Models.SearchCompletedWorkOrders
@{
    ActionBarHelper.AddExportLink();
}
@(Html.TableFor(x => x, new { id = "results", @class = "results-table" })
      .SortableTemplateColumnFor("Order Number", "Id", x => @<text>
                                                                @Html.ActionLink(x.Id.ToString(), "Show", "GeneralWorkOrder", new { x.Id, area = "FieldOperations" }, null)
                                                             </text>)
      .SortableColumnFor(x => x.OperatingCenter)
      .SortableColumnFor(x => x.Town, "Town.ShortName")
      .SortableColumnFor(x => x.SAPWorkOrderNumber, "SAP WO No.", "SAPWorkOrderNumber")
      .SortableColumnFor(x => x.SAPNotificationNumber, "SAP Notif No.", "SAPNotificationNumber")
      .ColumnFor(x => x.StreetAddress)
      .SortableColumnFor(x => x.WorkDescription)
      .SortableColumnFor(x => x.AssetType)
      .SortableColumnFor(x => x.AssetId)
      .SortableColumnFor(x => x.CreatedBy)
      .SortableColumnFor(x => x.CreatedAt)
      .SortableColumnFor(x => x.DateReceived)
      .SortableColumnFor(x => x.RequestedBy)
      .SortableColumnFor(x => x.RequestingEmployee)
      .SortableColumnFor(x => x.CompletedBy)
      .SortableColumnFor(x => x.DateCompleted)
      .ColumnFor(x => x.OrderProcessTime)
      .SortableColumnFor(x => x.ApprovedBy)
      .SortableColumnFor(x => x.ApprovedOn)
      .ColumnFor(x => x.SupervisorProcessTime, "Supervisor Process Time")
      .ColumnFor(x => x.HasMaterialsUsed, "Materials")
      .SortableColumnFor(x => x.MaterialsApprovedBy)
      .SortableColumnFor(x => x.MaterialsApprovedOn)
      .ColumnFor(x => x.StockProcessTime)
      .SortableColumnFor(x => x.CurrentCrew)
      .SortableColumnFor(x => x.AccountCharged)
      .SortableColumnFor(x => x.WorkDescription.AccountingType, "WorkDescription.AccountingType")
      .ColumnFor(x => x.Notes)
      .WithCaption("Records found:" + Model.Count)
      .WithPaginatedFooter()
    )